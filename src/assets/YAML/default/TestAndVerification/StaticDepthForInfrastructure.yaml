---
Test and Verification:
  Static depth for infrastructure:
    Analyze logs:
      risk: Not aware of attacks happening.
      measure: Check logs for keywords.
      difficultyOfImplementation:
        knowledge: 2
        time: 2
        resources: 2
      usefulness: 3
      level: 3
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/sigmahq
      references:
        samm2: []
        iso27001-2017: []
        d3f:
        - PlatformMonitoring
      isImplemented: false
      evidence: ""
      comments: ""
    Check for image lifetime:
      risk: Old container images in production indicate that patch management is not
        performed and therefore vulnerabilities might exists.
      measure: Check the image age of containers in production.
      difficultyOfImplementation:
        knowledge: 2
        time: 1
        resources: 1
      usefulness: 2
      level: 2
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/clusterscanner
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - 12.6.1
        - 14.2.5
      isImplemented: false
      evidence: ""
      comments: ""
    Check for known vulnerabilities:
      risk: Known vulnerabilities in infrastructure components like container images
        might get exploited.
      measure: Check for known vulnerabilities
      difficultyOfImplementation:
        knowledge: 2
        time: 1
        resources: 1
      usefulness: 4
      level: 4
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/trivy
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/registries-like-quay
      references:
        samm2:
        - V-ST-2-A
        iso27001-2017:
        - 12.6.1
        d3f:
        - AssetVulnerabilityEnumeration
      isImplemented: false
      evidence: ""
      comments: ""
    Check for malware:
      risk: Third party might include  malware. Ether due to the maintainer (e.g.
        typo squatting of an image name and using the wrong image) or by an attacker
        on behalf of the maintainer with stolen credentials.
      measure: Check for malware in components (e.g. container images, VM baseline
        images, libraries).
      difficultyOfImplementation:
        knowledge: 2
        time: 2
        resources: 2
      usefulness: 3
      level: 3
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/clusterscanner
      references:
        samm2:
        - V-ST-2-A
        iso27001-2017:
        - 12.2.1
        d3f:
        - FileAnalysis
      isImplemented: false
      evidence: ""
      comments: ""
    Check for new image version:
      risk: When a new version of an image is available, it might fix security vulnerabilities.
      measure: Check for new images of containers in production.
      difficultyOfImplementation:
        knowledge: 3
        time: 3
        resources: 1
      usefulness: 2
      level: 3
      implementation: []
      references:
        samm2:
        - V-ST-2-A
        iso27001-2017:
        - 12.6.1
        - 14.2.5
        - 12.2.1
        d3f:
        - SoftwareUpdate
      isImplemented: false
      evidence: ""
      comments: ""
    Correlate known vulnerabilities in infrastructure with new image versions:
      risk: TODO.
      measure: TODO
      difficultyOfImplementation:
        knowledge: 2
        time: 5
        resources: 4
      usefulness: 1
      level: 4
      dependsOn:
      - Usage of a maximum lifetime for images
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/anchore-io
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/clair
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/openscap
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/vuls
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - 12.6.1
        - 14.2.1
        d3f:
        - AssetVulnerabilityEnumeration
      isImplemented: false
      evidence: ""
      comments: ""
    Stored Secrets:
      risk: Confidential information exposure via git history, in container images or in code.
      measure: Test for secrets presence in code, container images and commit history.
      difficultyOfImplementation:
        knowledge: 2
        time: 1
        resources: 2
      usefulness: 2
      level: 1
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/trufflehog
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/tw-talisman
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/go-pillage-registrie
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - vcs usage is not explicitly covered by ISO 27001 - too specific
        - 9.4.3
        - 10.1.2
        d3f:
        - ApplicationConfigurationHardening
      isImplemented: false
      evidence: ""
      comments: ""
    Test cluster deployment resources:
      risk: The deployment configuration (e.g. kubernetes deployment resources) might
        contain unsecured configurations.
      measure: Test the deployment configuration for virtualized environments for
        unsecured configurations.
      difficultyOfImplementation:
        knowledge: 2
        time: 1
        resources: 2
      usefulness: 3
      level: 2
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/kubesec
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - system hardening is not explicitly covered by ISO 27001 - too specific
        - 12.6.1
        - 14.2.3
        - 14.2.8
        d3f:
        - ApplicationConfigurationHardening
      isImplemented: false
      evidence: ""
      comments: ""
    Test of infrastructure components for known vulnerabilities:
      risk: Infrastructure components might have vulnerabilities.
      measure: Test for known vulnerabilities in infrastructure components. Often,
        the only way to respond to known vulnerabilities in operating system packages
        is to accept the risk and wait for a patch. As the patch needs to be applied
        fast when it is available, this activity depends on 'Usage of a maximum life
        for images'.
      difficultyOfImplementation:
        knowledge: 2
        time: 5
        resources: 2
      usefulness: 1
      level: 4
      dependsOn:
      - Usage of a maximum lifetime for images
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/anchore-io
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/clair
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/openscap
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/vuls
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - 12.6.1
        - 14.2.1
        d3f:
        - SystemVulnerabilityAssessment
      isImplemented: false
      evidence: ""
      comments: ""
    Test of virtualized environments:
      risk: Virtualized environments (e.g. via Container Images) might contains
        unsecure configurations.
      measure: Test virtualized environments for unsecured configurations.
      difficultyOfImplementation:
        knowledge: 2
        time: 1
        resources: 2
      usefulness: 3
      level: 2
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/wagoodman-dive
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/clusterscanner
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017: []
        d3f:
        - ApplicationConfigurationHardening
      isImplemented: false
      evidence: ""
      comments: ""
    Test the cloud configuration:
      risk: Standard hardening practices for cloud environments are not performed
        leading to vulnerabilities.
      measure: With the help of tools, the configuration of virtual environments are
        tested.
      difficultyOfImplementation:
        knowledge: 2
        time: 2
        resources: 1
      usefulness: 4
      level: 2
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/kube-bench
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - system hardening is not explicitly covered by ISO 27001 - too specific
        - 12.6.1
        - 14.2.3
        - 14.2.8
      isImplemented: false
      evidence: ""
      comments: ""
    Test the definition of virtualized environments:
      risk: The definition of virtualized environments (e.g. via <i>Dockerfile</i>)
        might contain unsecure configurations.
      measure: Test the definition of virtualized environments for unsecured configurations.
      difficultyOfImplementation:
        knowledge: 2
        time: 1
        resources: 2
      usefulness: 3
      level: 2
      meta:
        implementationGuide: For containier (images), test that the images are following
          best practices like distroless or non-root.
      implementation:
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/hadolint
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/deployment-with-kube
      - $ref: src/assets/YAML/default/implementations.yaml#/implementations/dockerfilelint
      references:
        samm2:
        - V-ST-1-A
        iso27001-2017:
        - system hardening, virtual environments are not explicitly covered by ISO
          27001 - too specific
        - 12.6.1
        - 14.2.3
        - 14.2.8
        - 14.2.1
      isImplemented: false
      evidence: ""
      comments: ""
...
